<!DOCTYPE html>
<html lang="en">
<head>
    {{ template "meta.gohtml" . }}
    <title>View Recording</title>
</head>
<body>
<header class="bg-white shadow-sm">
    <div class="container mx-auto p-4">
        <a href="/" class="text-lg text-blue-500 hover:text-blue-600 underline">&lt; go back</a>
    </div>
</header>

<div class="container mx-auto p-4">
    <div class="mb-12">
        <h1 class="text-2xl font-bold">Discovered Potholes</h1>
    </div>
    <span class="text-red-500">{{ .Error }}</span>

    <div class="flex mb-16 bg-white">
        <div class="flex-1 w-2/5">
            <div class="flex items-center">
                <span class="w-4 h-4 rounded-full opacity-75 bg-green-600"></span>
                <p class="ml-2 text-sm font-medium">Video Uploaded</p>
            </div>
            {{ if eq .Status "CREATED" }}
                <div class="flex items-center">
                    <span class="w-4 h-4 animate-pulse rounded-full bg-gray-200"></span>
                    <p class="ml-2 text-sm font-medium text-blue-500 hover:text-blue-600 underline">Trigger Analysis</p>
                </div>
            {{ else if eq .Status "PROCESSING" }}
                <div class="flex items-center">
                    <span class="w-4 h-4 animate-pulse rounded-full bg-blue-400"></span>
                    <p class="ml-2 text-sm font-medium">Analyzing...</p>
                </div>
            {{ else if eq .Status "FINISHED" }}
                <div class="flex items-center">
                    <span class="w-4 h-4 rounded-full opacity-75 bg-green-600"></span>
                    <p class="ml-2 text-sm font-medium">Analysis Complete</p>
                </div>
            {{ else if eq .Status "FAILED" }}
                <div class="flex items-center">
                    <span class="w-4 h-4 rounded-full opacity-75 bg-red-500"></span>
                    <p class="ml-2 text-sm font-medium text-blue-500 hover:text-blue-600 underline">
                        Analysis Failed (trigger again)
                    </p>
                </div>
            {{ end }}
            <div class="flex items-center">
                <span class="w-4 h-4 rounded-full opacity-75 bg-gray-200"></span>
                <p class="ml-2 text-sm font-medium text-blue-500 hover:text-blue-600 underline">GPX</p>
            </div>
        </div>
        <div class="flex-1 w-3/5">
            <video controls hx-preserve>
                <source src="/videos/{{ .VideoName }}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
    </div>

    {{/*TODO: add analyze button to send this recording for analysis*/}}

    {{/*TODO: show stacked bar graph of N potholes at time in the video */}}
    {{/*https://chartscss.org/components/stacked/*/}}

    <div>
        {{ range .Detections }}
            <div class="flex mb-6 bg-white">
                <div class="flex-1 w-2/5">
                    <img src="/images/{{ .FileName }}" alt="Placeholder Image" class="max-w-full h-auto object-cover">
                </div>

                <div class="flex-1 w-3/5">
                    <div class="ml-6">
                        <div class="flex justify-between mb-6 items-baseline">
                            <div class="text-xl font-semibold">ID: {{ .ID }}</div>
                            <button class="px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 focus:outline-none">
                                Delete
                            </button>
                            {{/*TODO: implement detele*/}}
                        </div>
                        <div>Confidence: {{ formatFloat (mul .Confidence 100) }}%</div>
                        <div>Frame: {{ .FrameNumber }}/{{ .TotalFrameNumber }}</div>
                    </div>
                </div>
            </div>
        {{ end }}
    </div>
</div>

</body>
</html>